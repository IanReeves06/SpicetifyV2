(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[472],{60391:function(e,i,n){"use strict";n.r(i),n.d(i,{Episode:function(){return fe},MUSIC_PLUS_TALK_TRIGGER_ID:function(){return ge},default:function(){return Se},parseReleaseDate:function(){return ye}});var t=n(27378),a=n.n(t),l=n(79308),d=n(48529),s=n(35181),r=n(66917),o=n.n(r),c=n(7444),m=n(46471),u=n(65701),v=n(7487),k=n(34834),p="episode-episode-episode",g="episode-episode-contentDescription",f="episode-episode-contentDescriptionTitle",S=n(93261),y=n(88319),E=n(9807),N=n(60042),h=n.n(N),b=n(32311),F=n(76654),D=n(37539),w="episode-episodeEntityHeader-container",I="episode-episodeEntityHeader-smallHeader",L=n(75533),A=n(72136),M=n(21311),P=n(99209),R=n(26380),U=n(32049),x=n(34159),C=n(33482),T=n(48936);const _=e=>{const i=o().from(e);return`/show/${o().hexToId((null==i?void 0:i.id)||"")}`},B=({uri:e,backgroundColor:i,backgroundImages:n,size:l,data:d,playButtonWrapper:s=null,contextMenuWrapper:r=T.j,onPlayClick:o,isPlaying:c,isLocked:m=!1,isPlayDisabled:u=!1,playButtonRef:v,actionBarHeader:k,actionBarButtons:p})=>{const g=(0,t.useRef)(null),{imageUrl:f}=(0,b.f)(n,g),{title:S="",subtitle:y="",subtitleLinkURI:N,type:B,displayType:Z,images:z}=d;return a().createElement(a().Fragment,null,a().createElement("div",{"data-testid":"container",ref:g,style:{backgroundColor:i},className:h()(D.Z.container,w,D.Z.overlay,{[D.Z.withBackgroundImage]:f,[D.Z.smallHeader]:l===C.f.SMALL,[I]:l===C.f.SMALL})},a().createElement(P.Du,null,a().createElement(x.JM,{size:x.qE.sm,onClick:o,isPlaying:c,disabled:u,locked:m}),a().createElement(P.yZ,{text:S})),f&&a().createElement(a().Fragment,null,a().createElement("div",{"data-testid":"background-image",className:h()(D.Z.background,D.Z.gradient),style:{backgroundImage:`url(${f})`}}),a().createElement("div",{className:h()(D.Z.background,D.Z.overlay)})),a().createElement(r,{uri:e,contextUri:e},a().createElement(A.O,{title:S,className:D.Z.image,size:l===C.f.SMALL?M.m$.SIZE_56:M.m$.SIZE_200,type:B,images:z,shape:A.K.ROUNDED_CORNERS})),a().createElement(L.sP,null,l!==C.f.SMALL&&a().createElement(E.Dy.p,{variant:E.$e.minuetBold},Z),a().createElement(r,{uri:e,contextUri:e},a().createElement(L.xd,{size:l===C.f.SMALL?U.Jj.SMALL:U.Jj.LARGE},S)),a().createElement(L.dy,{small:l===C.f.SMALL,large:l===C.f.LARGE},N&&a().createElement(r,{uri:N,contextUri:e},a().createElement(F.rU,{to:_(N)},y))))),a().createElement(R.o,{backgroundColor:i,size:l===C.f.SMALL?R.m.SMALL:R.m.LARGE,playButton:l===C.f.MOBILE?null:a().createElement("div",{className:D.Z.stickyPlayButton,ref:v},s?s(a().createElement(x.JM,{size:x.qE.lg,onClick:o,isPlaying:c,disabled:u,locked:m})):a().createElement(x.JM,{size:x.qE.lg,onClick:o,isPlaying:c,disabled:u,locked:m})),header:k,secondaryActionButtons:p}))};var Z=n(64619),z=n(69816),$=n(404),O=n(28234),q=n(88886),V=n(18237),G=n(27272),W=n(39536),J=n(12275),H=n(13564),K=n(21723),j=n(91486),Q=n(54798),X=n(17922),Y=n(47574),ee=n(54220),ie=n(25227),ne=n(70685),te=n(1721),ae=n(81971),le=n(79974);const de=e=>(0,ae.a)(le.getEpisode,e);var se=n(29510),re="episode-episodesShelf-EpisodesShelf",oe="episode-episodesShelf-Title",ce="episode-episodesShelf-EpisodesList";var me=({title:e,episodes:i,className:n})=>a().createElement("div",{className:h()(re,n)},a().createElement(E.Dy,{as:"h2",variant:E.Dy.canon,className:oe},e),a().createElement("div",{className:ce},i.map((e=>a().createElement(se.B,{key:e.id,entity:e}))))),ue=n(91300);const ve=({uri:e,limit:i})=>{var n;const{data:l}=(d={uri:e,limit:i},(0,ae.a)(ue.getRecommendedEpisodes,d));var d;const r=(0,t.useMemo)((()=>{var e;return((null==l||null===(e=l.episode)||void 0===e?void 0:e.recommendedEpisodes.items)||[]).map((e=>{var i,n,t,a,l,d,s;return{id:e.episode.id,uri:e.episode.uri,name:e.episode.name,description:null!==(i=e.episode.description)&&void 0!==i?i:"",explicit:(null===(n=e.episode.contentRating)||void 0===n?void 0:n.label)===$.KS.Explicit,release_date:ye(null===(t=e.episode.releaseDate)||void 0===t?void 0:t.isoString),duration_ms:e.episode.duration.totalMilliseconds,images:null!==(a=null===(l=e.episode.coverArt)||void 0===l?void 0:l.sources)&&void 0!==a?a:[],show:{images:null!==(d=null===(s=e.episode.podcast.coverArt)||void 0===s?void 0:s.sources)&&void 0!==d?d:[]}}}))}),[null==l||null===(n=l.episode)||void 0===n?void 0:n.recommendedEpisodes.items]);return(null==r?void 0:r.length)>0?a().createElement(me,{title:s.ag.get("mwp.entity.might.like"),episodes:r}):null};var ke=n(89743);const pe=({children:e,uri:i,contextUri:n})=>a().createElement(J._,{menu:a().createElement(V.k,{uri:i,contextUri:n})},e),ge="activation-trigger-mme",fe=e=>{var i,n,r,N,h,b,F,D,w;const{uri:I}=e,L=(0,d.TH)(),A=(0,l.I0)(),M=(0,y.o)(),P=(0,Y.W6)(Q.Cz),{data:R}=de({uri:I}),U=null==R?void 0:R.episode,[x,T]=(0,t.useState)((null==U?void 0:U.playedState.state)===$.sY.Completed),_=(0,te.g)(),{triggerPlay:J,togglePlay:ae,isPlaying:le,isActive:se}=(0,ne.n)({uri:I},{featureIdentifier:"episode"}),re=(0,ke.F)(),oe=null==re?void 0:re.position,ce=null==U||null===(i=U.podcast)||void 0===i?void 0:i.uri,me=null==U?void 0:U.type,ue={displayType:me===$.Wf.Episode?s.ag.get("type.showEpisode"):s.ag.get("type.podcastEpisode"),title:(null==U?void 0:U.name)||"",subtitle:null==U||null===(n=U.podcast)||void 0===n?void 0:n.name,subtitleLinkURI:null==U||null===(r=U.podcast)||void 0===r?void 0:r.uri,images:(null==U||null===(N=U.coverArt)||void 0===N?void 0:N.sources)||[],type:Z.p.EPISODE},fe=null==U||null===(h=U.coverArt)||void 0===h||null===(b=h.sources)||void 0===b||null===(F=b[0])||void 0===F?void 0:F.url,Se=(0,W.Z)(fe||null);(0,t.useEffect)((()=>{var e;if(!U)return;const{name:i,podcast:n}=U;A((0,c.Dk)(s.ag.get("podcasts.episode.seo.title",{name:i,show:null!==(e=null==n?void 0:n.name)&&void 0!==e?e:""})))}),[A,U]);const Ee=(0,l.v9)((e=>{var i;return null===(i=e.platform)||void 0===i?void 0:i.isBrowser})),Ne=!(null!=U&&U.playability.playable)&&(null==U?void 0:U.playability.reason)===$.Ku.PaymentRequired,he=(0,t.useCallback)(((e,i=!0)=>{if(Ne||!U)return;const n=parseInt(e,10)||0;let t="play";!le||0!==n&&i||(t="pause"),M({intent:t,targetUri:I,type:"click",itemIdSuffix:n>0?"podcast-description-timestamp":"button"}),me===$.Wf.Episode&&Ee?m.y.set((()=>({triggerId:ge,triggerAction:null}))):se&&!i?_?A((0,u.Xh)()):ae():_?A((0,u.mU)(U,n)):J({seekTo:n})}),[Ne,le,M,I,U,me,Ee,se,_,A,ae,J]),be=(0,t.useCallback)((()=>{M({intent:"expand-description",type:"click"})}),[M]),Fe=(0,t.useCallback)((e=>{const i=a().createElement(ie.l,{enabled:Ne},e);return Ee?a().createElement(O.c,{id:ge,targetURI:o().from(I)},i):i}),[Ne,Ee,I]),De=(null==U?void 0:U.description)||P&&(null==U?void 0:U.htmlDescription),we=!Ne&&!(null!=U&&U.playability.playable);return(0,t.useEffect)((()=>{if(U){const e=new URLSearchParams(L.search);if(e.has("t")){const i=e.get("t")||"0",n=1e3*parseInt(i,10);n<=U.duration.totalMilliseconds&&he(n)}}}),[U]),U?a().createElement("section",{"data-testid":"episode",className:p},a().createElement(B,{uri:U.uri,backgroundColor:Se,size:C.f.LARGE,data:ue,onPlayClick:()=>{var e;he(null!==(e=null==U?void 0:U.playedState.playPositionMilliseconds)&&void 0!==e?e:0,!1)},isPlaying:le,isPlayDisabled:we,isLocked:Ne,playButtonWrapper:Fe,contextMenuWrapper:pe,actionBarHeader:a().createElement(S.E,{size:S.$.LARGE,fullyPlayed:x,durationMs:U.duration.totalMilliseconds,releaseDate:ye(null===(D=U.releaseDate)||void 0===D?void 0:D.isoString),resumePositionMs:null!==(w=null==U?void 0:U.playedState.playPositionMilliseconds)&&void 0!==w?w:0,isPlaying:le,position:se&&oe||void 0}),actionBarButtons:a().createElement(a().Fragment,null,!Ne&&a().createElement(k.p,{uri:U.uri,showUri:ce}),a().createElement(X.F,{property:Q.eh,renderNewExperience:()=>a().createElement(K.w,{uri:U.uri,size:j.q.md})}),a().createElement(q.y,{menu:a().createElement(V.k,{uri:I,sharingInfo:U.sharingInfo,showUri:ce,contextUri:I,isPlayed:x,onMarkAsPlayed:T})},a().createElement(G.z,null)))}),a().createElement("div",{className:"contentSpacing"},De&&a().createElement(a().Fragment,null,a().createElement(E.Dy,{as:"h2",variant:E.$e.canon,color:"var(--spice-text)",className:f},s.ag.get("episode.description-title")),a().createElement(z.o,{className:g,onTimeStampClick:he,maxLines:4,onExpanded:be,content:(U.description||"").trim(),htmlContent:P&&U.htmlDescription?U.htmlDescription:void 0,LinkComponent:ee.Z,enableTimestamps:U.playability.playable})),a().createElement(H.N,e),a().createElement(ve,{uri:I,limit:6}))):a().createElement(v.h,{errorMessage:s.ag.get("error.not_found.title.podcast")})};var Se=a().memo((()=>{const{episodeId:e}=(0,d.UO)(),i=o().episodeURI(e).toURI();return a().createElement(t.Suspense,{fallback:null},a().createElement(fe,{uri:i,key:i}))}));function ye(e){return(null==e?void 0:e.replace(/T.*/,""))||""}},79974:function(e){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getEpisode"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"uri"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"htmlDescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"duration"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"playability"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reason"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"playedState"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playPositionMilliseconds"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"releaseDate"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isoString"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"podcast"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"coverArt"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"trailer"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"sharingInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shareId"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:736}};i.loc.source={body:"query getEpisode($uri: ID!) {\n  episode(uri: $uri) {\n    id\n    uri\n    name\n    htmlDescription\n    description\n    duration {\n      totalMilliseconds\n    }\n    playability {\n      playable\n      reason\n    }\n    playedState {\n      playPositionMilliseconds\n      state\n    }\n    releaseDate {\n      isoString\n    }\n    coverArt {\n      sources {\n        url\n        width\n        height\n      }\n    }\n    type\n    podcast {\n      uri\n      name\n      # The coverart is not shown on the page but it is needed for accountless playback\n      coverArt {\n        sources {\n          url\n          width\n          height\n        }\n      }\n      trailer {\n        uri\n      }\n    }\n    sharingInfo {\n      shareUrl\n      shareId\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,i){if("FragmentSpread"===e.kind)i.add(e.name.value);else if("VariableDefinition"===e.kind){var t=e.type;"NamedType"===t.kind&&i.add(t.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,i)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,i)})),e.definitions&&e.definitions.forEach((function(e){n(e,i)}))}var t={};function a(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}i.definitions.forEach((function(e){if(e.name){var i=new Set;n(e,i),t[e.name.value]=i}})),e.exports=i,e.exports.getEpisode=function(e,i){var n={kind:e.kind,definitions:[a(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var l=t[i]||new Set,d=new Set,s=new Set;for(l.forEach((function(e){s.add(e)}));s.size>0;){var r=s;s=new Set,r.forEach((function(e){d.has(e)||(d.add(e),(t[e]||new Set).forEach((function(e){s.add(e)})))}))}return d.forEach((function(i){var t=a(e,i);t&&n.definitions.push(t)})),n}(i,"getEpisode")},91300:function(e){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getRecommendedEpisodes"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recommendedEpisodes"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"uri"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"releaseDate"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isoString"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"duration"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"podcast"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coverArt"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}]}}]}}],loc:{start:0,end:724}};i.loc.source={body:"query getRecommendedEpisodes($uri: ID!, $limit: Int) {\n  episode(uri: $uri) {\n    recommendedEpisodes(limit: $limit) {\n      items {\n        episode {\n          id\n          uri\n          name\n          description\n          releaseDate {\n            isoString\n          }\n          duration {\n            totalMilliseconds\n          }\n          contentRating {\n            label\n          }\n          coverArt {\n            sources {\n              url\n              width\n              height\n            }\n          }\n          podcast {\n            coverArt {\n              sources {\n                url\n                width\n                height\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,i){if("FragmentSpread"===e.kind)i.add(e.name.value);else if("VariableDefinition"===e.kind){var t=e.type;"NamedType"===t.kind&&i.add(t.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,i)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,i)})),e.definitions&&e.definitions.forEach((function(e){n(e,i)}))}var t={};function a(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}i.definitions.forEach((function(e){if(e.name){var i=new Set;n(e,i),t[e.name.value]=i}})),e.exports=i,e.exports.getRecommendedEpisodes=function(e,i){var n={kind:e.kind,definitions:[a(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var l=t[i]||new Set,d=new Set,s=new Set;for(l.forEach((function(e){s.add(e)}));s.size>0;){var r=s;s=new Set,r.forEach((function(e){d.has(e)||(d.add(e),(t[e]||new Set).forEach((function(e){s.add(e)})))}))}return d.forEach((function(i){var t=a(e,i);t&&n.definitions.push(t)})),n}(i,"getRecommendedEpisodes")}}]);
//# sourceMappingURL=xpui-routes-episode.js.map