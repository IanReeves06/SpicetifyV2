(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[727],{5377:function(e,t,a){"use strict";a.r(t),a.d(t,{QueueHistoryRoutes:function(){return ye},default:function(){return he}});var n=a(27378),r=a.n(n),l=a(48529),c=a(10053),s=a(66917),i=a.n(s),u=a(79378),o=a(50878),m=a(31645),d=a(65526),f=a.n(d),b=a(62088),p=a(59650);function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){f()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const g=[];var y=a(40299),h=a(61750),k=a(64619);const x=r().memo((({items:e})=>{const t=function(e){const[t,a]=(0,n.useState)({});return(0,n.useEffect)((()=>{const n=Array.from(new Set(e)),r=n.filter((e=>i().isTrack(e)&&!t[e])),l=n.filter((e=>i().isEpisode(e)&&!t[e])),c=r.length?b.fQ.getTracks(p.b.getInstance(),r.map((e=>i().from(e).getBase62Id()))).then((e=>e.body.tracks||g)):Promise.resolve(g),s=l.map((e=>b.UY.getEpisodeGraphQL(p.b.getInstance(),i().from(e).getBase62Id()).then((e=>(null==e?void 0:e.body)||{}))));Promise.all([c,...s]).then((([e,...t])=>{const n={},r={};e.forEach((e=>{var t;n[(null==e||null===(t=e.linked_from)||void 0===t?void 0:t.uri)||e.uri]=e})),t.forEach((e=>{r[e.uri]=e})),(e.length>0||t.length>0)&&a((e=>v(v(v({},e),n),r)))}))}),[e,t]),e.map((e=>t[e]))}(e.map((e=>e.uri))).map(((t,a)=>e[a].isLocal?e[a]:t)),a=(0,n.useCallback)(((e,t)=>{if((n=e).type===k.p.TRACK&&i().isTrack(n.uri)){var a;const n=(0,y.X)(null===(a=e.album)||void 0===a?void 0:a.images,{desiredSize:40});return r().createElement(m.Lk,{key:t+e.uri,index:t,uri:(0,h.$V)(e),name:e.name,duration_ms:e.duration_ms,imgUrl:(null==n?void 0:n.url)||"",album:e.album,artists:e.artists,isExplicit:e.explicit,isMOGEFRestricted:(e.tags||[]).includes("MOGEF-19+")})}var n,l,c;if((e=>e.type===k.p.EPISODE)(e)){var s;const a=(0,y.X)(null===(s=e.show)||void 0===s?void 0:s.images,{desiredSize:40});return r().createElement(m.Lk,{key:t+e.uri,index:t,uri:(0,h.$V)(e),name:e.name,duration_ms:e.duration_ms,imgUrl:(null==a?void 0:a.url)||"",album:{name:e.show.name,uri:e.show.uri},artists:[{name:e.show.publisher,uri:""}],isExplicit:e.explicit,isMOGEFRestricted:!1})}return(e=>e.type===k.p.TRACK&&i().isLocalTrack(e.uri))(e)?r().createElement(m.Lk,{key:t+e.uri,index:t,uri:e.uri,name:e.name,duration_ms:e.duration,imgUrl:e.imageUrl||"",album:{name:(null===(l=e.album)||void 0===l?void 0:l.name)||"",uri:""},artists:[{name:(null===(c=e.artist)||void 0===c?void 0:c.name)||"",uri:""}],isExplicit:e.isExplicit,isMOGEFRestricted:!1}):r().createElement(u.hU,{height:`${u.dN}px`})}),[]);return r().createElement(r().Fragment,null,r().createElement(o.ZP,{value:"play-history-tracklist"},r().createElement(u.Pv,{ariaLabel:"play-history",hasHeaderRow:!0,columns:[u.QD.TITLE,u.QD.ALBUM_OR_PODCAST,u.QD.DURATION],renderRow:a,resolveUri:e=>e.uri,tracks:t,nrTracks:t.length,rowPlaceholder:u.hU,limit:50})))}));var O=a(14298),w=a(9807),N=a(68463),C=a(35181),D="queue-emptyState-emptyContainer",_="queue-emptyState-emptyContainerTitle",I="queue-emptyState-findSomething";const q=()=>r().createElement("div",{className:D},r().createElement(N.l,{iconSize:64}),r().createElement(w.Dy.h1,{variant:w.$e.alto,color:O.$_Y.white,className:_},C.ag.get("history.empty-title")),r().createElement("p",null,C.ag.get("history.empty-description")));var P="queue-playHistory-container",T="queue-playHistory-title";const U=()=>{const e=(0,c.U5)();return e&&e.items.length>0?r().createElement("div",{className:P},r().createElement(w.Dy.h1,{variant:w.$e.canon,color:O.$_Y.white,className:T},C.ag.get("view.recently-played")),r().createElement(x,{items:e.items})):r().createElement(q,null)};var S=a(60042),L=a.n(S),$=a(79308),R=a(54220),A=a(28979),j=a(82907),F=a(7444),Q=a(88319),Y=a(65701);const B=r().memo((({tracks:e,ariaLabel:t,contextUri:a,rowNumberOffset:l=0,section:c,usePlayContextItem:s})=>{const o=(0,Q.o)(),m=(0,$.I0)(),d=(0,n.useCallback)(((e,t)=>{o({intent:"remove-from-queue",type:"click"}),m((0,Y.m6)(e.map((e=>e.id)))),t()}),[m,o]),f=(0,n.useCallback)(((e,t)=>{if(E=e,i().isEpisode(E.uri)){var n;const i=(0,y.X)(null===(n=e.show)||void 0===n?void 0:n.images,{desiredSize:40});return r().createElement(u.pD,{key:t+l+e.uid,index:t,rowNumberOffset:l,imgUrl:(null==i?void 0:i.url)||"",uri:(0,h.$V)(e),uid:e.uid,contextUri:a,duration_ms:e.duration_ms,name:e.name,artists:[{name:e.show.publisher,uri:""}],album:{name:e.show.name,uri:e.show.uri},isExplicit:e.explicit,isPlayable:e.is_playable,isMOGEFRestricted:!1,type:u.jO.EPISODE,section:c,usePlayContextItem:s})}if((e=>i().isTrack(e.uri))(e)){var o;const n=(0,y.X)(null==e||null===(o=e.album)||void 0===o?void 0:o.images,{desiredSize:40});return r().createElement(u.pD,{key:t+l+e.uid,index:t,rowNumberOffset:l,imgUrl:(null==n?void 0:n.url)||"",uri:(0,h.$V)(e),uid:e.uid,contextUri:a,duration_ms:e.duration_ms,name:e.name,artists:e.artists,album:e.album,isExplicit:e.explicit,isPlayable:e.is_playable,isMOGEFRestricted:(e.tags||[]).includes("MOGEF-19+"),type:u.jO.TRACK,section:c,usePlayContextItem:s})}var m,d,f,b,p,E;return(e=>i().isLocalTrack(e.uri))(e)?r().createElement(u.pD,{key:t+l+e.uid,index:t,rowNumberOffset:l,imgUrl:(null==e||null===(m=e.metadata)||void 0===m?void 0:m.image_url)||"",uri:e.uri,uid:e.uid,contextUri:a,duration_ms:parseInt(null==e||null===(d=e.metadata)||void 0===d?void 0:d.duration,10)||0,name:null==e||null===(f=e.metadata)||void 0===f?void 0:f.title,artists:[{name:null==e||null===(b=e.metadata)||void 0===b?void 0:b.artist_name,uri:""}],album:{name:null==e||null===(p=e.metadata)||void 0===p?void 0:p.album_title,uri:""},isExplicit:!1,isPlayable:!0,isMOGEFRestricted:!1,type:u.jO.LOCAL,section:c,usePlayContextItem:s}):r().createElement(u.Lb,{height:`${u.dN}px`})}),[l,a,c,s]);return e&&r().createElement(u.Pv,{ariaLabel:t,tracks:e,nrTracks:e.length,onRemove:d,renderRow:f,resolveUri:e=>{var t;return(null===(t=e.linked_from)||void 0===t?void 0:t.uri)||e.uri},resolveUid:e=>e.uid,columns:[u.QD.INDEX,u.QD.TITLE,u.QD.ALBUM,u.QD.DURATION]})}));var M="queue-clearButton-button",z=a(64954);const G=({onClick:e})=>r().createElement(z.z,{className:M,version:"outlined",onClick:e,title:C.ag.get("queue.clear-queue")},r().createElement(w.Dy,{variant:w.$e.minuetBold},C.ag.get("queue.clear-queue")));var W="queue-queue-container",X="queue-queue-title",V="queue-queue-subTitle",Z="queue-queue-contextLink",K="queue-queue-queuedHeader",H=a(43938),J="queue-clearQueueDialog-container",ee="queue-clearQueueDialog-title",te="queue-clearQueueDialog-description",ae="queue-clearQueueDialog-buttonContainer",ne="queue-clearQueueDialog-cancelButton",re=a(91188),le=a(58558);const ce=r().memo((({onClose:e,onConfirm:t,isOpen:a,itemCount:l})=>{const c=(0,n.useCallback)((a=>{t(),e(a)}),[t,e]),s=C.ag.get("queue.confirm-title",l);return r().createElement(re.Z,{shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,onRequestClose:e,contentLabel:s,isOpen:a},r().createElement("div",{className:J},r().createElement(w.Dy,{as:"h2",variant:w.Dy.cello,className:ee},s),r().createElement(w.Dy,{as:"p",variant:w.Dy.mesto,className:te},C.ag.get("queue.confirm-message")),r().createElement("div",{className:ae},r().createElement(le.Y,{className:ne,version:"tertiary",onClick:e},C.ag.get("queue.cancel-button")),r().createElement(le.Y,{version:"primary",onClick:c},C.ag.get("queue.confirm-button")))))}));var se=a(70685),ie=a(86806),ue=a(18291);var oe=a(76654),me=a(86152);const de=()=>r().createElement("div",{className:D},r().createElement(me.j,{iconSize:64}),r().createElement(w.Dy.h1,{variant:w.$e.alto,color:O.$_Y.white,className:_},C.ag.get("queue.empty-title")),r().createElement("p",null,C.ag.get("queue.empty-description")),r().createElement(oe.OL,{to:"/search",className:I},r().createElement(le.Y,{version:"secondary"},C.ag.get("queue.fine-something")))),fe=()=>{const{currentTrack:e,nextTracks:t,currentDecoratedTrack:a,queuedDecoratedTracks:l,nextDecoratedTracks:c,isFetching:s}=(0,$.v9)(j.Un)||{},{uri:i,description:u}=(0,ue.Y)((e=>{var t,a,n;return{uri:null!==(t=null==e?void 0:e.context.uri)&&void 0!==t?t:null,description:null!==(a=null==e||null===(n=e.context.metadata)||void 0===n?void 0:n[ie.sb.CONTEXT_DESCRIPTION])&&void 0!==a?a:null}}),{uri:null,description:null}),m=(0,$.I0)(),[d,f]=(0,n.useState)(!1);(0,n.useEffect)((()=>{m((0,A._T)({currentTrack:e,nextTracks:t}))}),[m,e,t]),(0,n.useEffect)((()=>{m((0,F.Dk)(C.ag.get("queue.page-title")))}),[m]);const b=(0,n.useCallback)((()=>{f(!1)}),[f]),p=(0,n.useCallback)((()=>{m((0,Y.B5)()),f(!1)}),[m]),E=(0,n.useCallback)((()=>{f(!0)}),[f]),{usePlayContextItem:v}=(0,se.n)({uri:null!=i?i:""},{featureIdentifier:"queue"}),g=!(null==l||!l.length),y=!(null==c||!c.length);return!1===s&&!1===(a||g||y)?r().createElement(de,null):r().createElement("section",{className:W},r().createElement(w.Dy.h1,{variant:w.$e.canon,color:O.$_Y.white,className:X},C.ag.get("playback-control.queue")),a&&i&&r().createElement(r().Fragment,null,r().createElement(w.Dy.h2,{variant:w.$e.balladBold,color:O.$_Y.gray70},C.ag.get("queue.now-playing")),r().createElement(o.ZP,{value:"now-playing"},r().createElement(B,{ariaLabel:C.ag.get("queue.now-playing"),tracks:[a],contextUri:i,section:H.hb.NowPlaying,usePlayContextItem:v}))),g&&i&&r().createElement(r().Fragment,null,r().createElement("div",{className:L()(K,V)},r().createElement(w.Dy.h2,{variant:w.$e.balladBold,color:O.$_Y.gray70},C.ag.get("queue.next-in-queue")),g&&r().createElement(G,{onClick:E})),r().createElement(o.ZP,{value:"next-in-queue"},r().createElement(B,{ariaLabel:C.ag.get("queue.next-in-queue"),tracks:l||[],rowNumberOffset:1,contextUri:"spotify:app:queue:NextInQueue",section:H.hb.NextInQueue,usePlayContextItem:v}))),y&&i&&r().createElement(r().Fragment,null,r().createElement(w.Dy.h2,{variant:w.$e.balladBold,color:O.$_Y.gray70,className:L()(V,"standalone-ellipsis-one-line")},u?C.ag.get("queue.next-from"):C.ag.get("queue.next-up")," ",r().createElement(R.r,{className:Z,to:i},u)),r().createElement(o.ZP,{value:"next-up"},r().createElement(B,{ariaLabel:C.ag.get("queue.next-up"),tracks:c||[],rowNumberOffset:1+((null==l?void 0:l.length)||0),contextUri:"spotify:app:queue:NextUp",section:H.hb.NextUp,usePlayContextItem:v}))),r().createElement(ce,{itemCount:(null==l?void 0:l.length)||0,isOpen:d,onClose:b,onConfirm:p}))};var be=a(60210),pe=a(69895),Ee=a(18299),ve="queue-queueHistoryTopBar-tabBar";const ge=()=>{const[e,t]=(0,n.useState)(window.innerWidth);(0,be.a)((()=>{t(window.innerWidth)}));const a=(0,n.useMemo)((()=>[{title:C.ag.get("playback-control.queue"),itemId:"queue",to:"/queue"},{title:C.ag.get("view.recently-played"),itemId:"history",to:"/history"}]),[]);return r().createElement(Ee.w,null,r().createElement(pe.n,{className:ve,links:a,windowSize:e}))},ye=()=>{const e=(0,c.nF)();return r().createElement("section",{className:"contentSpacing"},e&&r().createElement(l.AW,{path:"/history"},r().createElement(U,null)),r().createElement(l.AW,{path:"/queue"},r().createElement(n.Suspense,{fallback:null},r().createElement(fe,null))),e&&r().createElement(ge,null))};var he=ye},69895:function(e,t,a){"use strict";a.d(t,{n:function(){return w}});var n=a(27378),r=a.n(n),l=a(60042),c=a.n(l),s=a(72724),i=a(35181),u="queue-tabBar-nav",o="queue-tabBar-headerCentered",m="queue-tabBar-headerItem",d="queue-tabBar-moreButton",f="queue-tabBar-moreButtonActive",b="queue-tabBar-dropdownItemLink",p="queue-tabBar-active",E="queue-tabBar-headerItemLink",v="queue-tabBar-header",g="queue-tabBar-chevron",y=a(9807),h=a(36256),k=a(34761),x=a(79744);const O=({items:e,activeItemId:t,setActiveDropdownItem:a})=>r().createElement(k.v,null,e.map((e=>r().createElement(x.s,{role:"menuitemradio",to:e.to,exact:!0,"aria-checked":e.itemId===t,className:b,activeClassName:p,isActive:t=>!!t&&(a(e),!0),onClick:()=>{a(e)}},e.title)))),w=r().memo((({isCentered:e,links:t,landmarkLabel:a,className:l,windowSize:b=1/0})=>{const[k,x]=(0,n.useState)(null),w=(0,n.useRef)(null),[N,C]=(0,n.useState)([]),[D,_]=(0,n.useState)(0),[I,q]=(0,n.useState)([]);(0,n.useEffect)((()=>{w.current&&_(w.current.clientWidth)}),[b]),(0,n.useEffect)((()=>{if(!w.current)return;const e=Array.from(w.current.children).map((e=>e.clientWidth));C(e)}),[t]),(0,n.useEffect)((()=>{if(!w.current)return;if(N.slice(0,-1).reduce(((e,t)=>e+t),0)<=D)return void q([]);const e=N.reduce(((e,t)=>e>t?e:t),0),t=[];let a=e;N.forEach(((e,n)=>{D>=a+e?a+=e:t.push(n)})),q(t)}),[D,N]);const P=(0,n.useCallback)((e=>!!e&&(x(null),!0)),[]);return r().createElement("nav",{className:c()(l,u),"aria-label":a},r().createElement("ul",{className:e?o:v,ref:w},t.filter(((e,t)=>!I.includes(t))).map((e=>r().createElement("li",{key:e.to,className:m},r().createElement(s.O,{exact:!0,className:E,activeClassName:p,to:e.to,isActive:P},r().createElement(y.Dy,{variant:y.Dy.mestoBold},e.title))))),I.length||0===N.length?r().createElement("li",{className:m},r().createElement(h.xV,{renderInline:!0,menu:r().createElement(O,{items:t.filter(((e,t)=>I.includes(t))),activeItemId:null==k?void 0:k.itemId,setActiveDropdownItem:x})},((e,t,a)=>r().createElement("button",{className:c()(d,{[f]:k}),type:"button",onClick:t,ref:a},r().createElement(y.Dy,{as:"span",variant:y.Dy.mestoBold},k?k.title:i.ag.get("more")),r().createElement("span",{className:c()(g,{"spoticon-chart-up-16":e,"spoticon-chart-down-16":!e})}))))):null))}))}}]);
//# sourceMappingURL=xpui-routes-queue.js.map